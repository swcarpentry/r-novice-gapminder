---
title: "Introduction to R and RStudio"
teaching: 45
exercises: 10
questions:
- "¿Cómo orientarse en RStudio?"
- "¿Cómo interactuar con R?"
- "¿Cómo administrar tu entorno?"
- "¿Cómo instalar paquetes?"
objectives:
- "Describir el propósito y el uso de cada panel del RStudio IDE"
- "Ubicar botones y opciones en RStudio IDE"
- "Definir una variable"
- "Asignar un dato a una variable"
- "Administrar un espacio de trabajo en una sesión R interactiva"
- "Usar operadores matemáticos y de comparación"
- "Llamar funciones"
- "Gestionar paquetes"
keypoints:
- "Usar RStudio para escribir y correr programas en R."
- "R tiene operadores aritméticos y funciones matemáticas usuales."
- "Utilizar `<-` para asignar valores a variables."
- "Utilizar `ls()` para listar las variables en el programa."
- "Utilizar `rm()` para eliminar objetos en el programa."
- "Utilizar `install.packages()` para instalar paquetes (libraries)."
source: Rmd
---


## Motivación


La Ciencia es un proceso de varios pasos: una vez que hayas diseñado un experimento y recopilado datos, ¡comienza la verdadera diversión! Esta lección te enseñará cómo comenzar este proceso usando R y RStudio. Comenzaremos con datos brutos, realizaremos análisis exploratorios y aprenderemos a trazar gráficamente los resultados. Este ejemplo comienza con un conjunto de datos de [gapminder.org] (https://www.gapminder.org) que contiene información sobre la población de muchos países a lo largo del tiempo. ¿Puedes leer estos datos en R? ¿Puedes hacer un gráfico de la población de Senegal? ¿Puedes calcular el ingreso promedio de los países del continente asiático? Al final de estas lecciones, ¡podrás hacer cosas como graficar datos de poblaciones de estos países en menos de un minuto!


## Antes de empezar el taller 

Asegúrate de tener instalada la última versión de R y RStudio en tu máquina. Esto es importante, ya que algunos paquetes utilizados en el taller pueden no instalarse correctamente (o no funcionar) si R no está actualizado.

[Download and install the latest version of R here](https://www.r-project.org/)
[Download and install RStudio here](https://www.rstudio.com/)


## Introducción a RStudio


Bienvenido a la parte R del taller de Software Carpentry.


A lo largo de esta lección, vamos a enseñarte algunos de los fundamentos del lenguaje R, así como algunas buenas prácticas para organizar el código de proyectos científicos que harán tu vida más fácil.


We'll be using RStudio: a free, open source R integrated development environment. It provides a built in editor, works on all platforms (including on servers) and provides many advantages such as integration with version
control and project management.
Usaremos RStudio: un entorno de desarrollo integrado y gratuito de código abierto. Proporciona un editor incorporado, funciona en todas las plataformas (incluso en servidores) y ofrece muchas ventajas, como la integración con la versión control y gestión de proyectos.


**Diseño básico**


Cuando abres por primera vez el RStudio, serás recibido por tres paneles:


  * La consola interactiva de R (a la izquierda)
  * Ambiente/Historial (en la esquina superior derecha)
  * Archivos/Gráficos/Paquetes/Ayuda/Visor (abajo a la derecha)


![RStudio layout](../fig/01-rstudio.png)


Una vez que abres archivos, como los scripts R, también se abrirá un panel de editor en la esquina superior izquierda.


![RStudio layout with .R file open](../fig/01-rstudio-script.png)


## Flujo de trabajo dentro de RStudio
Hay dos formas principales en que uno puede trabajar dentro de RStudio.


1. Probar y jugar dentro de la consola interactiva de R y luego copiar el código en un archivo .R para ejecutarlo más tarde.
   *  Esto funciona bien cuando se hacen pequeñas pruebas y se está comenzando.
   *  Rápidamente se vuelve laborioso. 
2. Comienza a escribir un archivo en .R y usa las teclas de acceso directo de RStudio para Ejecutar la línea actual, las líneas seleccionadas o modificadas en la consola interactiva.
   * Esta es una buena forma de comenzar; todo tu código es guardado para después.
   * Podrás ejecutar el archivo que crees desde RStudio o mediante la función `source ()` de R.


> ## Sugerencia: Running segments of your code
>
> RStudio ofrece gran flexibilidad para ejecutar código desde dentro de la ventana del editor
> Hay botones, opciones de menú y atajos de teclado. Para ejecutar la línea actual, puedes 
> 1. hacer clic en el botón `Run` arriba en el panel del Editor, o  2. Seleccioná "Run Lines" desde el menú 
> "Code", o  3. Presionar Ctrl-Enter en Windows o Linux o Command-Enter en OS X. (Este atajo también se 
> puede hacer colocando el mouse sobre el botón). Para ejecutar un bloque de código, selecciónalo y luego 
> pulsa `Run`. Si has modificado una línea de código dentro de un bloque que acabas de ejecutar,
> no es necesario re-seleccionar  el bloque y `Run`, puedes usar el botón 
> `Re-run the previous region`. Esto ejecutará el bloque de código anterior, incluidas las modificaciones que 
> has realizado.
{: .callout}


## Introducción a R


Gran parte de tu tiempo en R lo gastarás en la consola interactiva de R. Aquí es donde ejecutarás todo tu código, y puede ser un entorno útil para probar ideas antes de guardarlas en un script R. La consola en RStudio es la misma que obtendrías si escribieras en líneas de comando en el entorno `R`.


Lo primero que verás en la sesión interactiva R es un montón de información, seguido de un cursor ">" y un cursor parpadeante. En este sentido, esto es similar al entorno de shell que aprendiste durante las lecciones de shell: opera con la misma idea de "leer, evaluar, mostrar": escribe comandos, R intenta ejecutarlos y luego devuelve un resultado.


## Usando R como una calculadora
Lo más simple que podrías hacer con R es hacer aritmética:


~~~
1 + 100
~~~
{: .r}






~~~
[1] 101
~~~
{: .output}


Y R mostrará la respuesta, precedido de un "[1]". No te preocupes por esto por ahora, lo explicaremos más adelante. Por ahora piensa en eso como la salida.


Al igual que bash, si escribes un comando incompleto, R esperará a que lo completes:


~~~
> 1 +
~~~
{: .r}


~~~
+
~~~
{: .output}


Cada vez que presionas return y R muestra un "+" en lugar de ">", significa que está esperando que completes el comando. Si desea cancelar un comando, simplemente presione "Esc" y RStudio le devolverá el mensaje ">".




> ## Sugerencia: Cancelando comandos
>
> Si usas R desde la línea de comando en lugar de estar dentro de RStudio, 
> debe usar `Ctrl + C` en lugar de` Esc` para cancelar el comando. 
> ¡Esto también se aplica bien a los usuarios de Mac!
>
> La cancelación de un comando no solo es útil para matar comandos incompletos: 
> también puedes usarlo para decirle a R que deje de ejecutar el código (por ejemplo, si tarda 
> mucho más de lo que esperaba), o para deshacerte del código que estás escribiendo actualmente.
>
{: .callout}


Cuando se usa R como calculadora, el orden de las operaciones es el mismo que has aprendido en la escuela.


De mayor a menor precedencia:


 * Paréntesis: `(`, `)`
 * Exponente: `^` o `**`
 * División: `/`
 * Multiplicación: `*`
 * Suma: `+`
 * Resta: `-`


~~~
3 + 5 * 2
~~~
{: .r}






~~~
[1] 13
~~~
{: .output}


Usa paréntesis para agrupar las operaciones, para forzar el orden de la evaluación si difiere de la predeterminada, o para aclarar lo que deseas hacer.




~~~
(3 + 5) * 2
~~~
{: .r}






~~~
[1] 16
~~~
{: .output}


Esto puede ser difícil de manejar cuando no es necesario, pero aclara tus intenciones.
Recuerde que otros pueden leer su código.




~~~
(3 + (5 * (2 ^ 2))) # difícil de leer
3 + 5 * 2 ^ 2       # claro, si recuerdas las reglas
3 + 5 * (2 ^ 2)     # si olvida algunas reglas, esto podría ayudar
~~~
{: .r}




El texto después de cada línea de código se llama "comentario". Todo lo que sigue después de que el símbolo hash (o numeral) `#` es ignorado por R cuando ejecuta el código.


Los números pequeños o grandes tienen una notación científica:




~~~
2/10000
~~~
{: .r}






~~~
[1] 2e-04
~~~
{: .output}




Es la abreviatura de "multiplicado por` 10 ^ XX` ". Entonces `2e-4` es la abreviatura de `2 * 10^(-4)`.


Puedes escribir números en notación científica también:


~~~
5e3  # falta el signo menos aquí
~~~
{: .r}




~~~
[1] 5000
~~~
{: .output}


## Funciones Matemáticas


R tiene muchas funciones matemáticas integradas. Para llamar a una función, simplemente escribimos su nombre, seguido paréntesis ( ). Todo lo que escribas dentro de los paréntesis se llama argumentos de la función:


~~~
sin(1)  # función trigonométrica
~~~
{: .r}




~~~
[1] 0.841471
~~~
{: .output}




~~~
log(1)  # logaritmo natural
~~~
{: .r}






~~~
[1] 0
~~~
{: .output}




~~~
log10(10) # logaritmo en base-10
~~~
{: .r}






~~~
[1] 1
~~~
{: .output}




~~~
exp(0.5) # e^(1/2)
~~~
{: .r}






~~~
[1] 1.648721
~~~
{: .output}


No te preocupes si trata de recordar todas las funciones en R. Simplemente puede buscarlas en Google, o si puedes recordar el comienzo del nombre de la función, usa el tabulador para completar su nombre en RStudio.


Esta es una de las ventajas que RStudio tiene sobre R, tiene capacidades de autocompletado que le permiten buscar funciones más fácilmente, sus argumentos y los valores que toman.


Escribir un `?` antes del nombre de un comando abrirá la página de ayuda para ese comando. Además de proporcionar una descripción detallada del comando y cómo funciona, al desplazarse hacia la parte inferior de la página de ayuda generalmente se mostrarán ejemplos que ilustran el uso del comando. Veremos un ejemplo más adelante.


## Comparando


Podemos realizar comparaciones en R:




~~~
1 == 1  # igualdad (observe dos signos iguales, se lee como "es igual a")
~~~
{: .r}






~~~
[1] TRUE
~~~
{: .output}




~~~
1 != 2  # desigualdad (leída como "no es igual a")
~~~
{: .r}






~~~
[1] TRUE
~~~
{: .output}




~~~
1 < 2  # menor que
~~~
{: .r}






~~~
[1] TRUE
~~~
{: .output}




~~~
1 <= 1  # menor o igual que
~~~
{: .r}






~~~
[1] TRUE
~~~
{: .output}




~~~
1 > 0  # mayor que
~~~
{: .r}






~~~
[1] TRUE
~~~
{: .output}




~~~
1 >= -9 # mayor o igual que
~~~
{: .r}






~~~
[1] TRUE
~~~
{: .output}


> ## Sugerencia: Comparando números
>
> Una advertencia sobre la comparación de números: 
> nunca debes usar `==` para comparar dos números a menos que 
> sean enteros (un tipo de datos que puede representar 
> específicamente solo números enteros).
>
> Las computadoras sólo pueden representar números decimales con 
> un cierto grado de precisión, así que dos números que parecen iguales 
> cuando se muestran por R, pueden tener diferentes representaciones 
> subyacentes y por lo tanto ser diferentes por un pequeño margen de error 
> (llamado tolerancia numérica de la máquina).


> En su lugar, debes usar la función `all.equal`.
>
> Lectura adicional: [http://floating-point-gui.de/](http://floating-point-gui.de/)
>
{: .callout}


## Variables y Asignaciones


Podemos almacenar valores en variables usando el operador de asignación `<-`, veamos ejemplos:




~~~
x <- 1/40
~~~
{: .r}


Observa que la asignación no muestra el valor. En cambio, lo almacena para más adelante en algo llamado ** variable **. `x` ahora contiene el ** valor **` 0.025`:




~~~
x
~~~
{: .r}






~~~
[1] 0.025
~~~
{: .output}


Más precisamente, el valor almacenado es una * aproximación decimal * de esta fracción llamada un [número en coma flotante] (http://en.wikipedia.org/wiki/Floating_point).


Busca la pestaña `Environment` en uno de los paneles de RStudio, y verás que` x` y su valor han aparecido. Nuestra variable `x` se puede usar en lugar de un número en cualquier cálculo que espere un número:


~~~
log(x)
~~~
{: .r}






~~~
[1] -3.688879
~~~
{: .output}


Ten en cuenta que las variables pueden reasignarse, es decir, puedes cambiar el valor almacenado en la variable:




~~~
x <- 100
~~~
{: .r}


`x` tenía el valor 0.025 y ahora tiene el valor 100.


También, los valores de asignación pueden contener la variable asignada:




~~~
x <- x + 1 #observa cómo RStudio actualiza la descripción de x en la pestaña superior derecha
y <- x * 2
~~~
{: .r}


El lado derecho de la asignación puede ser cualquier expresión de R válida.
La expresión del lado derecho * se evalúa por completo * antes de que se realice la asignación.


Los nombres de las variables pueden contener letras, números, guiones bajos y puntos. No pueden comenzar con un número ni contener espacios en absoluto. Diferentes personas usan diferentes convenciones para nombres largos de variables, estos incluyen


  * puntos.entre.palabras
  * guiones bajos\_entre_palabras
  * MayúsculasMinúsculasParaSepararPalabras


Lo que usa depende de vos, pero ** sé consistente **.


También es posible utilizar el operador `=` para la asignación:




~~~
x = 1/40
~~~
{: .r}


Esta forma es menos común entre los usuarios R. Lo más importante es
** sea consistente ** con el operador que usa. Ocasionalmente hay lugares
donde es menos confuso usar `<-` que` = `, y es el símbolo más común usado en la comunidad. 
Entonces la recomendación es usar `<-`.


## Vectorización


Una última cosa a tener en cuenta es que R está * vectorizado *, lo que significa que las variables y funciones pueden tener vectores como valores. Por ejemplo




~~~
1:5
~~~
{: .r}






~~~
[1] 1 2 3 4 5
~~~
{: .output}






~~~
2^(1:5)
~~~
{: .r}






~~~
[1]  2  4  8 16 32
~~~
{: .output}






~~~
x <- 1:5
2^x
~~~
{: .r}






~~~
[1]  2  4  8 16 32
~~~
{: .output}


Esto es increíblemente poderoso; discutiremos esto en una próxima lección.




## Administrando tu entorno


Hay algunos comandos útiles que puedes usar para interactuar con la sesión R.


`ls` listará todas las variables y funciones almacenadas en el entorno global
(tu sesión R de trabajo):






~~~
ls()
~~~
{: .r}






~~~
[1] "x" "y"
~~~
{: .output}


> ## Sugerencia: ocultando objetos
>
> Al igual que en el shell, `ls` oculta por defecto cualquier variable o función que comience
> con un ".". Para listar todos los objetos, escribe `ls (all.names = TRUE)` 
>
{: .callout}


Ten en cuenta que no se dió ningún argumento a `ls`, pero sí se necesita poner los paréntesis 
para decirle a R que llame a la función.


Si escribimos `ls` nada más, R mostrará el código fuente de esa función!




~~~
ls
~~~
{: .r}






~~~
function (name, pos = -1L, envir = as.environment(pos), all.names = FALSE, 
    pattern, sorted = TRUE) 
{
    if (!missing(name)) {
        pos <- tryCatch(name, error = function(e) e)
        if (inherits(pos, "error")) {
            name <- substitute(name)
            if (!is.character(name)) 
                name <- deparse(name)
            warning(gettextf("%s converted to character string", 
                sQuote(name)), domain = NA)
            pos <- name
        }
    }
    all.names <- .Internal(ls(envir, all.names, sorted))
    if (!missing(pattern)) {
        if ((ll <- length(grep("[", pattern, fixed = TRUE))) && 
            ll != length(grep("]", pattern, fixed = TRUE))) {
            if (pattern == "[") {
                pattern <- "\\["
                warning("replaced regular expression pattern '[' by  '\\\\['")
            }
            else if (length(grep("[^\\\\]\\[<-", pattern))) {
                pattern <- sub("\\[<-", "\\\\\\[<-", pattern)
                warning("replaced '[<-' by '\\\\[<-' in regular expression pattern")
            }
        }
        grep(pattern, all.names, value = TRUE)
    }
    else all.names
}
<bytecode: 0x7ffdf9e17638>
<environment: namespace:base>
~~~
{: .output}


Puedes usar `rm` para eliminar objetos que ya no necesitas:




~~~
rm(x)
~~~
{: .r}


Si tienes muchas cosas en tu entorno y deseas borrarlas todas, 
puedes pasar los resultados de `ls` a la función` rm`:




~~~
rm(list = ls())
~~~
{: .r}


En este caso, hemos combinado los dos. Al igual que el orden de las operaciones, todo lo que se encuentre dentro de los paréntesis más internos se evalúa primero, y así sucesivamente.


En este caso, hemos especificado que los resultados de `ls` se deben usar para el argumento ` list` en `rm`. Cuando asignes valores a argumentos por su nombre, * debes *
usa el operador `=` !!


Si, en cambio, usamos `<-`, habrá efectos secundarios no deseados, o puedes recibir un mensaje de error:




~~~
rm(list <- ls())
~~~
{: .r}






~~~
Error in rm(list <- ls()): ... must contain names or character strings
~~~
{: .error}


> ## Sugerencia: Advertencias vs. Errores
>
> ¡Presta atención cuando R hace algo inesperado! Los errores, como el anterior, 
> se lanzan cuando R no puede proceder a un cálculo. Por otro lado, las advertencias 
> generalmente significan que la función se ha ejecutado, pero probablemente 
> no funcionó como se esperaba.
>
> En ambos casos, el mensaje que muestra R usualmente te da pistas sobre cómo 
> solucionar el problema.
>
{: .callout}


## Paquetes en R


Es posible agregar funciones a R escribiendo un paquete u obteniendo un paquete escrito 
por otra persona. Hay más de 10,000 paquetes disponibles en CRAN (la red completa de archivos R). 
R y RStudio tienen funcionalidad para administrar paquetes:


* Puedes ver qué paquetes están instalados escribiendo `installed.packages ()`
* Puedes instalar paquetes escribiendo `install.packages (" packagename ")`, donde `packagename` es el nombre del paquete entre comillas.
* Puedes actualizar los paquetes instalados escribiendo `update.packages ()`
* Puedes eliminar un paquete con `remove.packages (" packagename ")`
* Puedes hacer que un paquete esté disponible para su uso con `library (packagename)`


> ## Desafío 1
>
> ¿Cuáles de los siguientes nombres de variables son válidos en R?
> 
> ~~~
> min_height
> max.height
> _age
> .mass
> MaxLength
> min-length
> 2widths
> celsius2kelvin
> ~~~
> {: .r}
>
> > ## Solución al desafío 1
> >
> > Las siguientes variables pueden ser utilizadas en R:
> > 
> > ~~~
> > min_height
> > max.height
> > MaxLength
> > celsius2kelvin
> > ~~~
> > {: .r}
> >
> > Lo siguiente crea una variable oculta:
> > 
> > ~~~
> > .mass
> > ~~~
> > {: .r}
> >
> > Lo siguiente no puede ser usado para crear una variable
> > 
> > ~~~
> > _age
> > min-length
> > 2widths
> > ~~~
> > {: .r}
> {: .solution}
{: .challenge}


> ## Desafío 2
>
> ¿Cuál será el valor de cada variable después de cada comando en el siguiente programa?
>
> 
> ~~~
> mass <- 47.5
> age <- 122
> mass <- mass * 2.3
> age <- age - 20
> ~~~
> {: .r}
>
> > ## Solución al desafío 2
> >
> > 
> > ~~~
> > mass <- 47.5
> > ~~~
> > {: .r}
> > Esto dará un valor de 47.5 para la variable mass
> >
> > 
> > ~~~
> > age <- 122
> > ~~~
> > {: .r}
> > Esto dará un valor de 122 para la variable age
> >
> > 
> > ~~~
> > mass <- mass * 2.3
> > ~~~
> > {: .r}
> > Multiplica el valor existente en mass 47.5 por 2.3 para dar un nuevo valor 
> > 109.25 a la variable mass.
> >
> > 
> > ~~~
> > age <- age - 20
> > ~~~
> > {: .r}
> > Resta 20 del valor existente de 122 para obtener un nuevo valor
> > de 102 para la variable age.
> {: .solution}
{: .challenge}




> ## Desafío 3
>
> Ejecuta el código del desafío anterior y escribe un comando para comparar la variable mass con age. 
> ¿mass es más grande que age?
>
> > ## Solución del desafío 3
> >
> > Una forma de responder esta pregunta en R es usar `>` para hacer lo siguiente:
> > 
> > ~~~
> > mass > age
> > ~~~
> > {: .r}
> > 
> > 
> > 
> > ~~~
> > [1] TRUE
> > ~~~
> > {: .output}
> > Esto debería dar un valor booleano TRUE ya que 109.25 es mayor que 102.
> {: .solution}
{: .challenge}




> ## Desafío 4
>
> > Limpia tu entorno de trabajo borrando las variables de mass y age.
>
> > ## Solución al desafío 4
> >
> > Podemos usar el comando `rm` para realizar esta tarea
> > 
> > ~~~
> > rm(age, mass)
> > ~~~
> > {: .r}
> {: .solution}
{: .challenge}


> ## Desafío 5
>
> Instala las siguientes paquetess: `ggplot2`, `plyr`, `gapminder`
>
> > ## Solución al desafío 5
> >
> > Puedes utilizar el comando `install.packages()` para instalar los paquetes requeridos.
> > 
> > ~~~
> > install.packages("ggplot2")
> > install.packages("plyr")
> > install.packages("gapminder")
> > ~~~
> > {: .r}
> {: .solution}
{: .challenge}
Key Points
* Usa RStudio para escribir y ejecutar programas en R.
* R tiene operadores aritméticos y funciones matemáticas usuales .
* Usa <- para asignar valores a variables.
* Usa ls() para listar las variables en un programa.
* Usa rm() para eliminar objetos en un programa.
* Usa install.packages() para instalar paquetes (librerías).
